"""Inline SVG pixel-art sprites for game items and icons.

Each sprite is a 16x16 pixel grid rendered as SVG <rect> elements.
The sprites scale cleanly at any size via viewBox.
"""

from typing import Dict


def _px(grid: list[list[str]], size: int = 16) -> str:
    """Convert a pixel grid (list of rows, each a list of hex colors) to SVG rects.

    Empty string or '.' means transparent.
    """
    rects = []
    for y, row in enumerate(grid):
        for x, color in enumerate(row):
            if color and color != ".":
                rects.append(
                    f'<rect x="{x}" y="{y}" width="1" height="1" fill="{color}"/>'
                )
    return "".join(rects)


def sprite_svg(name: str, size: int = 24, title: str = "") -> str:
    """Return a complete inline SVG for the named sprite.

    Args:
        name: Sprite key (e.g. 'rusty_sword', 'dagger').
        size: Display size in pixels.
        title: Optional tooltip text.
    """
    pixel_data = SPRITE_DATA.get(name.lower().replace(" ", "_"))
    if not pixel_data:
        return ""
    # Escape because `<title>` becomes part of the SVG DOM (defense-in-depth).
    safe_title = (
        str(title)
        .replace("&", "&amp;")
        .replace("<", "&lt;")
        .replace(">", "&gt;")
        .replace('"', "&quot;")
        .replace("'", "&#39;")
    )
    title_el = f"<title>{safe_title}</title>" if safe_title else ""
    return (
        f'<svg viewBox="0 0 16 16" width="{size}" height="{size}" '
        f'style="image-rendering:pixelated;vertical-align:middle;">'
        f"{title_el}{pixel_data}</svg>"
    )


def item_sprite(item_name: str, size: int = 20) -> str:
    """Get the sprite SVG for a game item by its display name."""
    key = item_name.lower().replace(" ", "_")
    key = _ITEM_KEY_ALIASES.get(key, key)
    sprite = sprite_svg(key, size=size, title=item_name)
    if sprite:
        return sprite
    return sprite_svg("item_generic", size=size, title=item_name)


def class_icon_svg(class_name: str, size: int = 28) -> str:
    """Get the class icon sprite."""
    key = f"class_{class_name.lower()}"
    return sprite_svg(key, size=size, title=class_name)


def stat_icon_svg(stat_name: str, size: int = 16) -> str:
    """Get a small stat icon sprite."""
    key = f"stat_{stat_name.lower()}"
    return sprite_svg(key, size=size, title=stat_name)


# ---------------------------------------------------------------------------
# Pixel art data
# ---------------------------------------------------------------------------
# Color palette:
_  = "."      # transparent
K  = "#2a2a2a"  # dark outline
G  = "#8b8b8b"  # gray metal
S  = "#b0b0b0"  # silver / light metal
W  = "#c9a54e"  # warm gold
Y  = "#facc15"  # bright gold/yellow
BR = "#6b3a1f"  # brown wood
LB = "#8b5a2b"  # light brown
R  = "#b91c1c"  # red
LR = "#ef4444"  # light red
GR = "#22c55e"  # green
LG = "#6ee7b7"  # light green
BL = "#3b82f6"  # blue
LBL = "#93c5fd" # light blue
P  = "#8b5cf6"  # purple
LP = "#c4b5fd"  # light purple
WH = "#f0f0f0"  # white/bright
OR = "#f97316"  # orange
DG = "#1a472a"  # dark green
CY = "#38bdf8"  # cyan

_ITEM_KEY_ALIASES = {
    "first_age_relic": "dawn_relic",
}

# Each grid is 16x16, colors can be any hex string
_RUSTY_SWORD = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,W,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,W,Y,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,W,Y,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,G,S,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,G,S,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,G,S,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,S,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,S,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,_,_,_,_,_,_,_,_],
    [_,_,BR,_,_,G,S,_,_,_,_,_,_,_,_,_],
    [_,_,_,BR,G,S,_,_,_,_,_,_,_,_,_,_],
    [_,_,W,BR,W,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,BR,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,BR,LB,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,BR,LB,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,BR,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_DAGGER = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,S,G,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,S,G,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,S,G,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,S,G,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,S,G,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,S,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,S,G,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,S,G,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,W,Y,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,W,Y,W,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,K,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,K,BR,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,K,BR,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,K,BR,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,K,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_LOCKPICKS = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,_,G,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,_,G,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,S,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,S,S,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,S,_,_,S,_,_,_,G,_,_,_,_,_,_,_],
    [_,S,_,_,S,_,_,_,G,S,_,_,_,_,_,_],
    [_,_,S,S,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,S,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,S,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,S,S,S,S,S,G,_,_,_,_,_,_,_],
]

_SHORTBOW = [
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,BR,LB,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,BR,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,_,BR,_,_,_,_,G,_,_,_,_,_,_],
    [_,_,_,BR,_,_,_,_,_,_,G,_,_,_,_,_],
    [_,_,BR,_,_,_,_,_,_,_,_,G,_,_,_,_],
    [_,_,BR,_,_,_,_,_,_,_,_,_,G,_,_,_],
    [_,BR,_,_,_,_,_,_,_,_,_,_,_,G,_,_],
    [_,BR,_,_,_,_,_,_,_,_,_,_,_,G,_,_],
    [_,_,BR,_,_,_,_,_,_,_,_,_,G,_,_,_],
    [_,_,BR,_,_,_,_,_,_,_,_,G,_,_,_,_],
    [_,_,_,BR,_,_,_,_,_,_,G,_,_,_,_,_],
    [_,_,_,_,BR,_,_,_,_,G,_,_,_,_,_,_],
    [_,_,_,_,_,BR,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,BR,LB,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
]

_QUIVER_OF_ARROWS = [
    [_,_,_,_,_,_,_,S,_,S,_,S,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,G,_,G,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,G,_,G,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,G,_,G,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,G,_,G,_,_,_,_],
    [_,_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,BR,LB,BR,LB,BR,LB,BR,LB,_,_,_],
    [_,_,_,_,_,_,BR,LB,BR,LB,BR,LB,_,_,_,_],
    [_,_,_,_,_,_,_,BR,LB,BR,LB,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,BR,LB,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,BR,_,_,_,_,_,_],
]

_ROPE = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,LB,BR,LB,BR,LB,BR,_,_,_,_,_,_],
    [_,_,_,LB,_,_,_,_,_,_,BR,_,_,_,_,_],
    [_,_,LB,_,_,_,_,_,_,_,_,BR,_,_,_,_],
    [_,_,LB,_,_,_,_,_,_,_,_,BR,_,_,_,_],
    [_,_,_,LB,_,_,_,_,_,_,BR,_,_,_,_,_],
    [_,_,_,_,LB,BR,LB,BR,LB,BR,_,_,_,_,_,_],
    [_,_,_,_,_,LB,_,_,_,_,BR,_,_,_,_,_],
    [_,_,_,_,LB,_,_,_,_,_,_,BR,_,_,_,_],
    [_,_,_,_,LB,_,_,_,_,_,_,BR,_,_,_,_],
    [_,_,_,_,_,LB,_,_,_,_,BR,_,_,_,_,_],
    [_,_,_,_,_,_,LB,BR,LB,BR,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_TORCH = [
    [_,_,_,_,_,_,_,Y,Y,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,Y,OR,Y,_,_,_,_,_,_,_],
    [_,_,_,_,_,Y,OR,R,OR,Y,_,_,_,_,_,_],
    [_,_,_,_,_,Y,OR,R,OR,Y,_,_,_,_,_,_],
    [_,_,_,_,_,_,OR,R,OR,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,OR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,BR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,LB,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_HEALING_POTION = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,G,_,_,_,G,_,_,_,_,_,_],
    [_,_,_,_,G,_,_,_,_,_,G,_,_,_,_,_],
    [_,_,_,_,G,R,R,R,R,R,G,_,_,_,_,_],
    [_,_,_,_,G,R,LR,LR,R,R,G,_,_,_,_],
    [_,_,_,_,G,R,LR,WH,LR,R,G,_,_,_,_],
    [_,_,_,_,G,R,LR,LR,R,R,G,_,_,_,_],
    [_,_,_,_,G,R,R,R,R,R,G,_,_,_,_,_],
    [_,_,_,_,G,R,R,R,R,R,G,_,_,_,_,_],
    [_,_,_,_,G,R,R,R,R,R,G,_,_,_,_,_],
    [_,_,_,_,_,G,G,G,G,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_ANCIENT_SHIELD = [
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,G,S,W,W,S,G,_,_,_,_,_],
    [_,_,_,_,G,S,W,Y,Y,W,S,G,_,_,_,_],
    [_,_,_,G,S,W,Y,WH,WH,Y,W,S,G,_,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,G,S,W,Y,WH,LBL,LBL,WH,Y,W,S,G,_,_],
    [_,_,_,G,S,W,Y,WH,WH,Y,W,S,G,_,_,_],
    [_,_,_,_,G,S,W,Y,Y,W,S,G,_,_,_,_],
    [_,_,_,_,_,G,S,W,W,S,G,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
]

_WARDEN_TOKEN = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,W,Y,Y,W,_,_,_,_,_,_],
    [_,_,_,_,_,W,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,_,W,Y,_,_,_,_,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,_,BL,BL,_,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,BL,LBL,LBL,BL,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,BL,LBL,LBL,BL,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,_,BL,BL,_,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,_,_,_,_,Y,W,_,_,_,_],
    [_,_,_,_,_,W,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,_,_,_,W,Y,Y,W,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,W,W,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_BRONZE_SEAL = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,W,W,W,W,W,W,_,_,_,_,_],
    [_,_,_,_,W,BR,BR,BR,BR,BR,W,_,_,_,_],
    [_,_,_,W,BR,W,_,_,_,W,BR,W,_,_,_],
    [_,_,_,W,BR,_,W,_,W,_,BR,W,_,_,_],
    [_,_,_,W,BR,_,_,W,_,_,BR,W,_,_,_],
    [_,_,_,W,BR,_,W,_,W,_,BR,W,_,_,_],
    [_,_,_,W,BR,W,_,_,_,W,BR,W,_,_,_],
    [_,_,_,_,W,BR,BR,BR,BR,BR,W,_,_,_,_],
    [_,_,_,_,_,W,W,W,W,W,W,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_ASHFANG_CHARM = [
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,_,_,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,OR,OR,OR,OR,OR,_,_,_,_,_,_],
    [_,_,_,_,OR,R,R,OR,R,R,OR,_,_,_,_,_],
    [_,_,_,OR,R,OR,R,R,R,OR,R,OR,_,_,_,_],
    [_,_,_,OR,R,R,R,Y,R,R,R,OR,_,_,_,_],
    [_,_,_,OR,R,OR,R,R,R,OR,R,OR,_,_,_,_],
    [_,_,_,_,OR,R,R,OR,R,R,OR,_,_,_,_,_],
    [_,_,_,_,_,OR,OR,OR,OR,OR,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_SIGNAL_ARROWS = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,R,LR,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,R,G,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,G,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,G,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,G,_,_,_,GR,LG,_,_,_,_,_],
    [_,_,_,_,G,_,_,_,GR,G,_,_,_,_,_,_],
    [_,_,_,G,_,_,_,G,_,_,_,_,_,_,_,_],
    [_,_,G,_,_,_,G,_,_,_,_,_,_,_,_,_],
    [_,G,_,_,_,G,_,_,_,_,_,_,_,_,_,_],
    [G,_,_,_,G,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,LB,LB,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,LB,_,_,LB,_,_,_,_,_,_,_,_,_,_],
]

_ECHO_LOCKET = [
    [_,_,_,_,_,_,W,Y,Y,W,_,_,_,_,_,_],
    [_,_,_,_,_,W,_,_,_,_,W,_,_,_,_,_],
    [_,_,_,_,_,_,W,_,_,W,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,W,W,_,_,_,_,_,_,_],
    [_,_,_,_,_,W,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,_,W,Y,P,LP,P,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,P,LP,WH,LP,P,Y,W,_,_,_],
    [_,_,_,W,Y,LP,WH,LP,WH,LP,Y,W,_,_,_],
    [_,_,_,W,Y,P,LP,WH,LP,P,Y,W,_,_,_],
    [_,_,_,_,W,Y,P,LP,P,Y,Y,W,_,_,_,_],
    [_,_,_,_,_,W,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,_,_,_,W,W,W,W,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_EMBER_SIGIL = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,OR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,OR,Y,OR,_,_,_,_,_,_,_],
    [_,_,_,_,_,OR,Y,WH,Y,OR,_,_,_,_,_,_],
    [_,_,_,_,OR,R,Y,Y,Y,R,OR,_,_,_,_,_],
    [_,_,_,OR,R,OR,R,Y,R,OR,R,OR,_,_,_,_],
    [_,_,OR,R,OR,_,OR,OR,OR,_,OR,R,OR,_,_],
    [_,_,_,OR,_,_,_,R,_,_,_,OR,_,_,_,_],
    [_,_,_,_,OR,_,_,R,_,_,OR,_,_,_,_,_],
    [_,_,_,_,_,OR,_,R,_,OR,_,_,_,_,_,_],
    [_,_,_,_,_,_,OR,R,OR,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,OR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_DAWN_RELIC = [
    [_,_,_,_,_,_,_,Y,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,Y,WH,Y,_,_,_,_,_,_,_],
    [_,_,_,_,_,Y,WH,WH,WH,Y,_,_,_,_,_,_],
    [_,_,_,Y,Y,WH,WH,WH,WH,WH,Y,Y,_,_,_],
    [_,_,Y,WH,WH,WH,WH,WH,WH,WH,WH,Y,_,_],
    [_,Y,WH,WH,WH,CY,CY,CY,WH,WH,WH,Y,_,_],
    [_,_,Y,WH,CY,CY,LBL,CY,CY,WH,Y,_,_,_],
    [_,_,_,Y,CY,LBL,WH,LBL,CY,Y,_,_,_,_,_],
    [_,_,Y,WH,CY,CY,LBL,CY,CY,WH,Y,_,_,_],
    [_,Y,WH,WH,WH,CY,CY,CY,WH,WH,WH,Y,_,_],
    [_,_,Y,WH,WH,WH,WH,WH,WH,WH,WH,Y,_,_],
    [_,_,_,Y,Y,WH,WH,WH,WH,WH,Y,Y,_,_,_],
    [_,_,_,_,_,Y,WH,WH,WH,Y,_,_,_,_,_,_],
    [_,_,_,_,_,_,Y,WH,Y,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,Y,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_ITEM_GENERIC = [
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,G,S,S,S,S,G,_,_,_,_,_],
    [_,_,_,_,G,S,S,S,S,S,S,G,_,_,_,_],
    [_,_,_,G,S,S,W,W,W,W,S,S,G,_,_,_],
    [_,_,G,S,S,W,Y,Y,Y,Y,W,S,S,G,_,_],
    [_,_,G,S,S,W,Y,WH,WH,Y,W,S,S,G,_,_],
    [_,_,G,S,S,W,Y,WH,WH,Y,W,S,S,G,_,_],
    [_,_,G,S,S,W,Y,WH,WH,Y,W,S,S,G,_,_],
    [_,_,G,S,S,W,Y,WH,WH,Y,W,S,S,G,_,_],
    [_,_,G,S,S,W,Y,Y,Y,Y,W,S,S,G,_,_],
    [_,_,_,G,S,S,W,W,W,W,S,S,G,_,_,_],
    [_,_,_,_,G,S,S,S,S,S,S,G,_,_,_,_],
    [_,_,_,_,_,G,S,S,S,S,G,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
]

# Class icons
_CLASS_WARRIOR = [
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,G,S,S,S,S,G,_,_,_,_,_],
    [_,_,_,_,G,S,S,S,S,S,S,G,_,_,_,_],
    [_,_,_,G,S,S,S,S,S,S,S,S,G,_,_,_],
    [_,_,G,S,S,S,S,S,S,S,S,S,S,G,_,_],
    [_,G,S,S,S,S,S,S,S,S,S,S,S,S,G,_],
    [_,G,S,S,S,S,R,R,R,R,S,S,S,S,G,_],
    [_,G,S,S,S,R,R,R,R,R,R,S,S,S,G,_],
    [_,_,G,S,S,S,S,S,S,S,S,S,S,G,_,_],
    [_,_,_,G,S,S,S,S,S,S,S,S,G,_,_,_],
    [_,_,_,_,G,S,S,S,S,S,S,G,_,_,_,_],
    [_,_,_,_,_,G,S,S,S,S,G,_,_,_,_,_],
    [_,_,_,_,_,_,G,S,S,G,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,G,G,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_CLASS_ROGUE = [
    [_,_,_,_,_,_,_,K,K,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,K,P,P,K,_,_,_,_,_,_],
    [_,_,_,_,_,K,P,LP,LP,P,K,_,_,_,_],
    [_,_,_,_,K,P,LP,LP,LP,LP,P,K,_,_,_],
    [_,_,_,_,K,P,LP,WH,WH,LP,P,K,_,_,_],
    [_,_,_,_,_,K,P,LP,LP,P,K,_,_,_,_,_],
    [_,_,_,_,_,_,K,K,K,K,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,K,K,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,K,P,P,K,_,_,_,_,_,_],
    [_,_,_,_,_,K,P,LP,LP,P,K,_,_,_,_],
    [_,_,_,_,K,P,LP,LP,LP,LP,P,K,_,_,_],
    [_,_,_,K,P,P,LP,LP,LP,LP,P,P,K,_,_],
    [_,_,K,P,P,K,K,K,K,K,K,P,P,K,_,_],
    [_,_,_,K,K,_,_,_,_,_,_,K,K,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_CLASS_ARCHER = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,GR,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,GR,LG,_],
    [_,_,_,DG,_,_,_,_,_,_,_,GR,_,_,_],
    [_,_,_,_,DG,_,_,_,_,_,GR,_,_,_,_],
    [_,_,_,_,_,DG,_,_,_,GR,_,_,_,_,_],
    [_,_,_,_,_,_,DG,_,GR,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,DG,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,DG,BR,DG,_,_,_,_,_,_],
    [_,_,_,_,_,DG,_,BR,_,DG,_,_,_,_,_],
    [_,_,_,_,DG,_,_,BR,_,_,DG,_,_,_,_],
    [_,_,_,DG,_,_,_,BR,_,_,_,DG,_,_,_],
    [_,_,DG,_,_,_,_,BR,_,_,_,_,DG,_,_],
    [_,DG,_,_,_,_,_,BR,_,_,_,_,_,DG,_],
    [_,_,DG,_,_,_,BR,LB,_,_,_,_,DG,_,_],
    [_,_,_,DG,DG,DG,_,_,_,_,DG,DG,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

# Stat icons (tiny 16x16)
_STAT_HP = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,R,R,_,_,_,_,R,R,_,_,_,_,_],
    [_,_,R,LR,LR,R,_,R,LR,LR,R,_,_,_,_],
    [_,_,R,LR,WH,LR,R,LR,LR,LR,R,_,_,_,_],
    [_,_,R,LR,LR,LR,LR,LR,LR,LR,R,_,_,_,_],
    [_,_,_,R,LR,LR,LR,LR,LR,R,_,_,_,_,_],
    [_,_,_,_,R,LR,LR,LR,R,_,_,_,_,_,_,_],
    [_,_,_,_,_,R,LR,R,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,R,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_STAT_GOLD = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,W,W,W,W,W,_,_,_,_,_,_],
    [_,_,_,_,W,Y,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,W,Y,Y,Y,Y,Y,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,Y,W,W,W,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,W,Y,_,_,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,Y,W,W,W,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,Y,_,_,W,Y,Y,W,_,_,_,_],
    [_,_,_,W,Y,Y,W,W,W,Y,Y,W,_,_,_,_],
    [_,_,_,_,W,Y,Y,Y,Y,Y,W,_,_,_,_,_],
    [_,_,_,_,_,W,W,W,W,W,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_STAT_STRENGTH = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,G,G,_,_,_,_,_,_,G,G,_,_,_],
    [_,_,G,S,S,G,_,_,_,_,G,S,S,G,_,_],
    [_,_,G,S,S,G,_,_,_,_,G,S,S,G,_,_],
    [_,_,G,S,S,G,G,G,G,G,G,S,S,G,_,_],
    [_,_,G,S,S,S,S,S,S,S,S,S,S,G,_,_],
    [_,_,G,S,S,S,S,S,S,S,S,S,S,G,_,_],
    [_,_,G,S,S,G,G,G,G,G,G,S,S,G,_,_],
    [_,_,G,S,S,G,_,_,_,_,G,S,S,G,_,_],
    [_,_,G,S,S,G,_,_,_,_,G,S,S,G,_,_],
    [_,_,_,G,G,_,_,_,_,_,_,G,G,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]

_STAT_DEXTERITY = [
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,GR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,GR,LG,GR,_,_,_,_,_,_],
    [_,_,_,_,_,GR,_,GR,_,GR,_,_,_,_,_],
    [_,_,_,_,GR,_,_,GR,_,_,GR,_,_,_,_],
    [_,_,_,GR,_,_,_,GR,_,_,_,GR,_,_,_],
    [_,_,GR,_,_,_,_,GR,_,_,_,_,GR,_,_],
    [_,_,_,GR,_,_,_,GR,_,_,_,GR,_,_,_],
    [_,_,_,_,GR,_,_,GR,_,_,GR,_,_,_,_],
    [_,_,_,_,_,GR,_,GR,_,GR,_,_,_,_,_],
    [_,_,_,_,_,_,GR,LG,GR,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,GR,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
    [_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],
]


# ---------------------------------------------------------------------------
# Build sprite data registry
# ---------------------------------------------------------------------------

SPRITE_DATA: Dict[str, str] = {
    "rusty_sword": _px(_RUSTY_SWORD),
    "dagger": _px(_DAGGER),
    "lockpicks": _px(_LOCKPICKS),
    "shortbow": _px(_SHORTBOW),
    "quiver_of_arrows": _px(_QUIVER_OF_ARROWS),
    "rope": _px(_ROPE),
    "torch": _px(_TORCH),
    "healing_potion": _px(_HEALING_POTION),
    "ancient_shield": _px(_ANCIENT_SHIELD),
    "warden_token": _px(_WARDEN_TOKEN),
    "bronze_seal": _px(_BRONZE_SEAL),
    "ashfang_charm": _px(_ASHFANG_CHARM),
    "signal_arrows": _px(_SIGNAL_ARROWS),
    "echo_locket": _px(_ECHO_LOCKET),
    "ember_sigil": _px(_EMBER_SIGIL),
    "dawn_relic": _px(_DAWN_RELIC),
    "first_age_relic": _px(_DAWN_RELIC),
    "item_generic": _px(_ITEM_GENERIC),
    # Class icons
    "class_warrior": _px(_CLASS_WARRIOR),
    "class_rogue": _px(_CLASS_ROGUE),
    "class_archer": _px(_CLASS_ARCHER),
    # Stat icons
    "stat_hp": _px(_STAT_HP),
    "stat_gold": _px(_STAT_GOLD),
    "stat_strength": _px(_STAT_STRENGTH),
    "stat_dexterity": _px(_STAT_DEXTERITY),
}
